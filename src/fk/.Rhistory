# Imports
library('geoR')
library('pracma')
library('gstat')
library(sp)
# Name of model
model_name <- 'model1'
# Read data for kappa estimates from rds file and turn into a dataframe:
# - Coordinates are degrees lon and lat
k0rds <- readRDS(sprintf("/Users/tnye/kappa/krige/%s_my_data.rds", model_name))
kappa <- k0rds$data
longitude <- k0rds$coords[,1]
latitude <- k0rds$coords[,2]
k0.data <- data.frame(longitude, latitude, kappa)
# Define coordinates
coordinates(k0.data) = ~longitude+latitude
# Initial values for regression (from Van Houtte et al., 2018)
ini.nug <- 0
ini.sill <- 0.2
ini.range <- 0.1
# Matern order (fixed) (from Van Houtte et al., 2018)
theta <- 0.5
# Make and plot variogram
k0.vgm = variogram(kappa~1, k0.data)
k0.fit = fit.variogram(k0.vgm, model = vgm(ini.sill, 'Mat', ini.range, kappa=theta, nugget=ini.nug))
# Save plot of variogram
png(file=sprintf('/Users/tnye/kappa/plots/paper/k0_semivariogram_%s.png',model_name),
width=600, height=350, res=300)
plot(k0.vgm, k0.fit, xlab="Distance (deg)", ylab="Semivariance",cex.lab=.5,cex.axis=.5)
k0.data <- data.frame(longitude, latitude, kappa)
dev.off()
latitude <- k0rds$coords[,2]
plot(k0.vgm, k0.fit, xlab="Distance (deg)", ylab="Semivariance",cex.lab=.5,cex.axis=.5)
# Imports
library('geoR')
library('pracma')
library('gstat')
library(sp)
# Name of model
model_name <- 'model1'
# Read data for kappa estimates from rds file and turn into a dataframe:
# - Coordinates are degrees lon and lat
k0rds <- readRDS(sprintf("/Users/tnye/kappa/krige/%s_my_data.rds", model_name))
kappa <- k0rds$data
longitude <- k0rds$coords[,1]
latitude <- k0rds$coords[,2]
k0.data <- data.frame(longitude, latitude, kappa)
# Define coordinates
coordinates(k0.data) = ~longitude+latitude
# Initial values for regression (from Van Houtte et al., 2018)
ini.nug <- 0
ini.sill <- 0.2
ini.range <- 0.1
# Matern order (fixed) (from Van Houtte et al., 2018)
theta <- 0.5
# Make and plot variogram
k0.vgm = variogram(kappa~1, k0.data)
k0.fit = fit.variogram(k0.vgm, model = vgm(ini.sill, 'Mat', ini.range, kappa=theta, nugget=ini.nug))
plot(k0.vgm, k0.fit, xlab="Distance (deg)", ylab="Semivariance",cex.lab=.5,cex.axis=.5)
k0.fit
# Imports
library('geoR')
library('pracma')
library('gstat')
library(sp)
# Name of model
model_name <- 'model1'
# Read data for kappa estimates from rds file and turn into a dataframe:
# - Coordinates are degrees lon and lat
k0rds <- readRDS(sprintf("/Users/tnye/kappa/krige/%s_my_data.rds", model_name))
kappa <- k0rds$data
longitude <- k0rds$coords[,1]
latitude <- k0rds$coords[,2]
k0.data <- data.frame(longitude, latitude, kappa)
# Define coordinates
coordinates(k0.data) = ~longitude+latitude
# Initial values for regression (from Van Houtte et al., 2018)
ini.nug <- 0
ini.sill <- 0.1
ini.range <- 0.1
# Matern order (fixed) (from Van Houtte et al., 2018)
theta <- 0.5
# Make and plot variogram
k0.vgm = variogram(kappa~1, k0.data)
k0.fit = fit.variogram(k0.vgm, model = vgm(ini.sill, 'Mat', ini.range, kappa=theta, nugget=ini.nug))
plot(k0.vgm, k0.fit, xlab="Distance (deg)", ylab="Semivariance",cex.lab=.5,cex.axis=.5)
k0.data
# Imports
library('geoR')
model <- 'model2'
k0_dat_csv <- read.csv(file = sprintf("/Users/tnye/kappa/krige/%s_coords.csv", model))
lon <- k0_dat_csv['Longitude']
lat <- k0_dat_csv['Latitude']
log_k <- k0_dat_csv['log10_kappa']
kappa <- k0_dat_csv['kappa']
covariates <- numeric(length(log_k))
# df <- data.frame("UTMx"=coords[,1], "UTMy"=coords[,2], "data"=log_k, "covariates"=covariates)
df <- data.frame("Longitude"=lon, "Latitude"=lat, "data"=kappa, "covariates"=covariates)
# data <- as.geodata(df, coords.col=1:2, data.col=3, covariates.col=4,
#                    "station_names"=df$station_names, data.names=NULL, covar.col=NULL,
#                    covar.names="obj.names")
data <- as.geodata(df, coords.col=1:2, data.col=3, covar.col=4,
"station_names"=df$station_names, data.names=NULL, covar.names="BAY")
saveRDS(data, file = sprintf("/Users/tnye/kappa/krige/%s_my_data.rds", model))
# Imports
library('geoR')
library('pracma')
library('gstat')
library(sp)
# Name of model
model_name <- 'model2'
k0rds <- readRDS(sprintf("/Users/tnye/kappa/krige/%s_my_data.rds", model_name))
kappa <- k0rds$data
longitude <- k0rds$coords[,1]
latitude <- k0rds$coords[,2]
k0.data <- data.frame(longitude, latitude, kappa)
length(kappa)
# Initial values for regression (from Van Houtte et al., 2018)
ini.nug <- 0
ini.sill <- 0.03
ini.range <- 0.1
# Matern order (fixed) (from Van Houtte et al., 2018)
theta <- 0.5
# Make and plot variogram
k0.vgm = variogram(kappa~1, k0.data)
k0rds <- readRDS(sprintf("/Users/tnye/kappa/krige/%s_my_data.rds", model_name))
kappa <- k0rds$data
longitude <- k0rds$coords[,1]
latitude <- k0rds$coords[,2]
k0.data <- data.frame(longitude, latitude, kappa)
# Define coordinates
coordinates(k0.data) = ~longitude+latitude
# Initial values for regression (from Van Houtte et al., 2018)
ini.nug <- 0
ini.sill <- 0.03
ini.range <- 0.1
# Matern order (fixed) (from Van Houtte et al., 2018)
theta <- 0.5
# Make and plot variogram
k0.vgm = variogram(kappa~1, k0.data)
k0.fit = fit.variogram(k0.vgm, model = vgm(ini.sill, 'Mat', ini.range, kappa=theta, nugget=ini.nug))
plot(k0.vgm, k0.fit, xlab="Distance (deg)", ylab="Semivariance",cex.lab=.5,cex.axis=.5)
# Imports
library('geoR')
model <- 'model2'
k0_dat_csv <- read.csv(file = sprintf("/Users/tnye/kappa/krige/%s_coords.csv", model))
lon <- k0_dat_csv['Longitude']
lat <- k0_dat_csv['Latitude']
log_k <- k0_dat_csv['log10_kappa']
kappa <- k0_dat_csv['kappa']
covariates <- numeric(length(log_k))
# df <- data.frame("UTMx"=coords[,1], "UTMy"=coords[,2], "data"=log_k, "covariates"=covariates)
df <- data.frame("Longitude"=lon, "Latitude"=lat, "data"=log_k, "covariates"=covariates)
# data <- as.geodata(df, coords.col=1:2, data.col=3, covariates.col=4,
#                    "station_names"=df$station_names, data.names=NULL, covar.col=NULL,
#                    covar.names="obj.names")
data <- as.geodata(df, coords.col=1:2, data.col=3, covar.col=4,
"station_names"=df$station_names, data.names=NULL, covar.names="BAY")
saveRDS(data, file = sprintf("/Users/tnye/kappa/krige/%s_my_data.rds", model))
# Read data for kappa estimates from rds file and turn into a dataframe:
# - Coordinates are degrees lon and lat
k0rds <- readRDS(sprintf("/Users/tnye/kappa/krige/%s_my_data.rds", model_name))
kappa <- k0rds$data
longitude <- k0rds$coords[,1]
latitude <- k0rds$coords[,2]
k0.data <- data.frame(longitude, latitude, kappa)
# Define coordinates
coordinates(k0.data) = ~longitude+latitude
# Initial values for regression (from Van Houtte et al., 2018)
ini.nug <- 0
ini.sill <- 0.03
ini.range <- 0.1
# Matern order (fixed) (from Van Houtte et al., 2018)
theta <- 0.5
# Make and plot variogram
k0.vgm = variogram(kappa~1, k0.data)
k0.fit = fit.variogram(k0.vgm, model = vgm(ini.sill, 'Mat', ini.range, kappa=theta, nugget=ini.nug))
plot(k0.vgm, k0.fit, xlab="Distance (deg)", ylab="Semivariance",cex.lab=.5,cex.axis=.5)
log_k
kappa
# Imports
library('geoR')
model <- 'model2'
k0_dat_csv <- read.csv(file = sprintf("/Users/tnye/kappa/krige/%s_coords.csv", model))
lon <- k0_dat_csv['Longitude']
lat <- k0_dat_csv['Latitude']
log_k <- k0_dat_csv['log10_kappa']
kappa <- k0_dat_csv['kappa']
covariates <- numeric(length(log_k))
# df <- data.frame("UTMx"=coords[,1], "UTMy"=coords[,2], "data"=log_k, "covariates"=covariates)
df <- data.frame("Longitude"=lon, "Latitude"=lat, "data"=kappa, "covariates"=covariates)
# data <- as.geodata(df, coords.col=1:2, data.col=3, covariates.col=4,
#                    "station_names"=df$station_names, data.names=NULL, covar.col=NULL,
#                    covar.names="obj.names")
data <- as.geodata(df, coords.col=1:2, data.col=3, covar.col=4,
"station_names"=df$station_names, data.names=NULL, covar.names="BAY")
saveRDS(data, file = sprintf("/Users/tnye/kappa/krige/%s_my_data.rds", model))
# Read data for kappa estimates from rds file and turn into a dataframe:
# - Coordinates are degrees lon and lat
k0rds <- readRDS(sprintf("/Users/tnye/kappa/krige/%s_my_data.rds", model_name))
kappa <- k0rds$data
longitude <- k0rds$coords[,1]
latitude <- k0rds$coords[,2]
k0.data <- data.frame(longitude, latitude, kappa)
kappa
# Define coordinates
coordinates(k0.data) = ~longitude+latitude
# Initial values for regression (from Van Houtte et al., 2018)
ini.nug <- 0
ini.sill <- 0.03
ini.range <- 0.1
# Matern order (fixed) (from Van Houtte et al., 2018)
theta <- 0.5
# Make and plot variogram
k0.vgm = variogram(kappa~1, k0.data)
k0.fit = fit.variogram(k0.vgm, model = vgm(ini.sill, 'Mat', ini.range, kappa=theta, nugget=ini.nug))
plot(k0.vgm, k0.fit, xlab="Distance (deg)", ylab="Semivariance",cex.lab=.5,cex.axis=.5)
k0.vgm = variogram(kappa~1, k0.data)
k0.fit = fit.variogram(k0.vgm, model = vgm(ini.sill, 'Sph', ini.range, nugget=ini.nug))
plot(k0.vgm, k0.fit, xlab="Distance (deg)", ylab="Semivariance",cex.lab=.5,cex.axis=.5)
k0.fit
